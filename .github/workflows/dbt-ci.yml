- name: Create profiles.yml
  shell: bash
  run: |
    mkdir -p ~/.dbt
    cat > ~/.dbt/profiles.yml << EOF
    ecommerce_analytics:
      target: dev
      outputs:
        dev:
          type: snowflake
          account: "${{ secrets.SNOWFLAKE_ACCOUNT }}"
          user: "${{ secrets.SNOWFLAKE_USER }}"
          password: "${{ secrets.SNOWFLAKE_PASSWORD }}"
          role: "${{ secrets.SNOWFLAKE_ROLE }}"
          warehouse: "${{ secrets.SNOWFLAKE_WAREHOUSE }}"
          database: "${{ secrets.SNOWFLAKE_DATABASE }}"
          schema: "${{ secrets.SNOWFLAKE_SCHEMA_STAGING }}"
          threads: 4
    EOF
